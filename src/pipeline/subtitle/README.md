# ğŸ¬ ìë§‰ ì´ë¯¸ì§€ ìƒì„± ì‹œìŠ¤í…œ

SSML mark íƒœê·¸ ê¸°ë°˜ìœ¼ë¡œ ì •í™•í•œ íƒ€ì´ë°ì— ë§ì¶° PNG ì‹œí€€ìŠ¤ë¥¼ ìë™ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ğŸ“‹ ê°œìš”

ì´ ì‹œìŠ¤í…œì€ **ìë™í™” íŒŒì´í”„ë¼ì¸**ì˜ **Phase 1.3: ìë§‰ ì´ë¯¸ì§€ ìƒì„± ì‹œìŠ¤í…œ**ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

### ğŸ¯ ì£¼ìš” ê¸°ëŠ¥
- **SSML mark íƒœê·¸ ê¸°ë°˜ ì •í™•í•œ íƒ€ì´ë°**: TTS ì‘ë‹µê³¼ ì™„ë²½ ë™ê¸°í™”
- **PNG ì‹œí€€ìŠ¤ ìë™ ìƒì„±**: ê° ì¥ë©´ë³„ë¡œ ë…ë¦½ì ì¸ ìë§‰ ì´ë¯¸ì§€
- **í…ìŠ¤íŠ¸ ì„¤ì • ì ìš©**: í°íŠ¸, í¬ê¸°, ìƒ‰ìƒ, ìœ„ì¹˜ ë“± ì™„ì „ ì»¤ìŠ¤í„°ë§ˆì´ì§•

## ğŸ—ï¸ ì‹œìŠ¤í…œ êµ¬ì¡°

```
src/pipeline/subtitle/
â”œâ”€â”€ __init__.py          # ëª¨ë“ˆ ì´ˆê¸°í™”
â”œâ”€â”€ text_renderer.py     # í…ìŠ¤íŠ¸ ë Œë”ë§ ì—”ì§„
â”œâ”€â”€ generator.py         # ìë§‰ ì´ë¯¸ì§€ ìƒì„±ê¸°
â””â”€â”€ README.md           # ì´ íŒŒì¼
```

## ğŸ¬ ì‚¬ì–‘ì„œ ì¤€ìˆ˜ ì‚¬í•­

### **1. ê° í–‰ë³„ë¡œ 2ê°œì˜ ë…ë¦½ì ì¸ í…ìŠ¤íŠ¸ í™”ë©´ ìƒì„±**
- **í™”ë©´ 1**: ìˆœë²ˆ + ì›ì–´ í…ìŠ¤íŠ¸ë§Œ í‘œì‹œ
- **í™”ë©´ 2**: ìˆœë²ˆ + ì›ì–´ + í•™ìŠµì–´ + ì½ê¸° í‘œì‹œ

### **2. SSML mark íƒœê·¸ ê¸°ë°˜ ì •í™•í•œ íƒ€ì´ë°**
- `scene_{N}_screen1_start/end`: í™”ë©´ 1 íƒ€ì´ë°
- `scene_{N}_screen2_start/end`: í™”ë©´ 2 íƒ€ì´ë°
- TTS API ì‘ë‹µê³¼ ì™„ë²½ ë™ê¸°í™”

### **3. PNG ì‹œí€€ìŠ¤ ìë™ ìƒì„±**
- ê° í™”ë©´ë³„ë¡œ ë…ë¦½ì ì¸ PNG íŒŒì¼
- FFmpeg concat ë¦¬ìŠ¤íŠ¸ ìë™ ìƒì„±
- ì •í™•í•œ ì§€ì† ì‹œê°„ ê³„ì‚°

## ğŸš€ ì‚¬ìš©ë²•

### **1. í…ìŠ¤íŠ¸ ë Œë”ëŸ¬ ì‚¬ìš©**

```python
from src.pipeline.subtitle import TextRenderer

renderer = TextRenderer()

# ê¸°ë³¸ í…ìŠ¤íŠ¸ ë Œë”ë§
image = renderer.render_text("ì•ˆë…•í•˜ì„¸ìš”!", 800, 600)

# ë‹¤ì¤‘ ë¼ì¸ í…ìŠ¤íŠ¸ ë Œë”ë§
lines = ["1", "ì•ˆë…•í•˜ì„¸ìš”!", "ä½ å¥½ï¼", "ë‹ˆí•˜ì˜¤!"]
image = renderer.render_multiline_text(lines, 800, 600)

# conversation í™”ë©´ 1 ë Œë”ë§
screen1_image = renderer.render_conversation_screen1(1, "ì•ˆë…•í•˜ì„¸ìš”!", 800, 600)

# conversation í™”ë©´ 2 ë Œë”ë§
screen2_image = renderer.render_conversation_screen2(
    1, "ì•ˆë…•í•˜ì„¸ìš”!", "ä½ å¥½ï¼", "ë‹ˆí•˜ì˜¤!", 800, 600
)
```

### **2. ìë§‰ ìƒì„±ê¸° ì‚¬ìš©**

```python
from src.pipeline.subtitle import SubtitleGenerator

generator = SubtitleGenerator()

# Manifestì—ì„œ ìë§‰ ì´ë¯¸ì§€ ì‹œí€€ìŠ¤ ìƒì„±
frames = generator.generate_from_manifest(manifest_data, "output_dir", fps=30)

# SSML mark íƒœê·¸ì—ì„œ ìë§‰ ì´ë¯¸ì§€ ì‹œí€€ìŠ¤ ìƒì„±
frames = generator.generate_from_ssml_marks(ssml_content, "output_dir", fps=30)

# FFmpeg concat ë¦¬ìŠ¤íŠ¸ ìƒì„±
generator.create_ffmpeg_concat_list("concat_list.txt")
```

### **3. í…ìŠ¤íŠ¸ ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•**

```python
# ì‚¬ìš©ì ì •ì˜ ì„¤ì • íŒŒì¼
custom_config = {
    "default_settings": {
        "font_size": 60,
        "font_color": "#00FF00",
        "stroke_color": "#000000",
        "stroke_width": 3,
        "background_color": "#000080",
        "padding": 30,
        "line_spacing": 15,
        "alignment": "center"
    }
}

# ì„¤ì • íŒŒì¼ë¡œ ë Œë”ëŸ¬ ì´ˆê¸°í™”
renderer = TextRenderer("custom_config.json")
```

## ğŸ“Š ìƒì„±ë˜ëŠ” ì´ë¯¸ì§€ êµ¬ì¡°

### **conversation íƒ€ì… ì˜ˆì‹œ**

#### **í™”ë©´ 1 (ìˆœë²ˆ + ì›ì–´)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â”‚
â”‚          1          â”‚
â”‚                     â”‚
â”‚      ì•ˆë…•í•˜ì„¸ìš”!      â”‚
â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **í™”ë©´ 2 (ìˆœë²ˆ + ì›ì–´ + í•™ìŠµì–´ + ì½ê¸°)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â”‚
â”‚          1          â”‚
â”‚                     â”‚
â”‚      ì•ˆë…•í•˜ì„¸ìš”!      â”‚
â”‚                     â”‚
â”‚       ä½ å¥½ï¼         â”‚
â”‚                     â”‚
â”‚       ë‹ˆí•˜ì˜¤!        â”‚
â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ í…ìŠ¤íŠ¸ ì„¤ì • ì˜µì…˜

### **ê¸°ë³¸ ì„¤ì •**
- **í°íŠ¸ í¬ê¸°**: 48px (ê¸°ë³¸ê°’)
- **í°íŠ¸ ìƒ‰ìƒ**: #FFFFFF (í°ìƒ‰)
- **í…Œë‘ë¦¬ ìƒ‰ìƒ**: #000000 (ê²€ì€ìƒ‰)
- **í…Œë‘ë¦¬ ë‘ê»˜**: 2px
- **ë°°ê²½ ìƒ‰ìƒ**: #000000 (ê²€ì€ìƒ‰)
- **íŒ¨ë”©**: 20px
- **ì¤„ ê°„ê²©**: 10px
- **ì •ë ¬**: center (ê°€ìš´ë°)

### **ì¥ë©´ë³„ ì„¤ì •**
- **intro/ending**: 64px, í°ìƒ‰ í…ìŠ¤íŠ¸
- **conversation screen1**: 56px, í°ìƒ‰ í…ìŠ¤íŠ¸
- **conversation screen2**: 48px, í°ìƒ‰ í…ìŠ¤íŠ¸

### **ì–¸ì–´ë³„ í°íŠ¸ ìë™ ì„ íƒ**
- **í•œê¸€**: NanumGothic.ttf
- **í•œì**: NotoSansCJK-Regular.ttc
- **ì˜ë¬¸**: NotoSans-Regular.ttf

## ğŸ“ ì¶œë ¥ íŒŒì¼

### **ìƒì„±ë˜ëŠ” íŒŒì¼ë“¤**
1. **PNG ì´ë¯¸ì§€ ì‹œí€€ìŠ¤**: ê° í™”ë©´ë³„ ìë§‰ ì´ë¯¸ì§€
2. **`subtitle_frames.json`**: í”„ë ˆì„ ì •ë³´ ë° ë©”íƒ€ë°ì´í„°
3. **`concat_list.txt`**: FFmpeg concat ë¦¬ìŠ¤íŠ¸

### **í”„ë ˆì„ ì •ë³´ êµ¬ì¡°**
```json
{
  "total_frames": 10,
  "resolution": "1920x1080",
  "output_directory": "output_dir",
  "frames": [
    {
      "frame_number": 0,
      "start_time": 0.0,
      "end_time": 5.0,
      "duration": 5.0,
      "scene_id": "conversation_01",
      "screen_type": "screen1",
      "content": ["1", "ì•ˆë…•í•˜ì„¸ìš”!"],
      "output_path": "path/to/image.png"
    }
  ]
}
```

## ğŸ”§ FFmpeg í†µí•©

### **concat ë¦¬ìŠ¤íŠ¸ ì˜ˆì‹œ**
```
file 'conversation_01_screen1_0000.png'
duration 5.0
file 'conversation_01_screen2_0001.png'
duration 19.0
file 'conversation_02_screen1_0002.png'
duration 5.0
...
```

### **FFmpeg ëª…ë ¹ì–´**
```bash
ffmpeg -f concat -safe 0 -i concat_list.txt -vsync vfr -pix_fmt yuv420p output_video.mp4
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

### **í…ŒìŠ¤íŠ¸ ì‹¤í–‰**
```bash
python test_subtitle_system.py
```

### **í…ŒìŠ¤íŠ¸ í•­ëª©**
1. âœ… í…ìŠ¤íŠ¸ ë Œë”ëŸ¬ í…ŒìŠ¤íŠ¸
2. âœ… ìë§‰ ìƒì„±ê¸° í…ŒìŠ¤íŠ¸
3. âœ… SSML mark íƒœê·¸ ê¸°ë°˜ ìƒì„± í…ŒìŠ¤íŠ¸
4. âœ… í…ìŠ¤íŠ¸ ì„¤ì • í…ŒìŠ¤íŠ¸

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### **í°íŠ¸ íŒŒì¼ ì„¤ì •**
- ê¸°ë³¸ í°íŠ¸ íŒŒì¼ë“¤ì´ `assets/fonts/` ë””ë ‰í† ë¦¬ì— ìˆì–´ì•¼ í•¨
- í°íŠ¸ íŒŒì¼ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ í°íŠ¸ ì‚¬ìš©

### **í•´ìƒë„ ì„¤ì •**
- Manifestì˜ `resolution` í•„ë“œì—ì„œ ìë™ ê°ì§€
- ê¸°ë³¸ê°’: 1920x1080

### **íƒ€ì´ë° ì •í™•ì„±**
- í˜„ì¬ëŠ” ì˜ˆìƒ ì§€ì† ì‹œê°„ ì‚¬ìš©
- ì‹¤ì œ TTS API ì‘ë‹µê³¼ í†µí•© ì‹œ ì •í™•í•œ íƒ€ì´ë° ì ìš© í•„ìš”

## ğŸ”® í–¥í›„ ê³„íš

### **Phase 1.4: FFmpeg í†µí•©**
- ì˜¤ë””ì˜¤-ë¹„ë””ì˜¤ ë™ê¸°í™”
- ìµœì¢… MP4 ë Œë”ë§
- í’ˆì§ˆ ìµœì í™”

### **ê³ ê¸‰ ê¸°ëŠ¥**
- ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
- í…œí”Œë¦¿ ì‹œìŠ¤í…œ
- ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ ê°œë°œíŒ€ì— ë¬¸ì˜í•˜ì„¸ìš”.

---

**ğŸ¬ Manifest ì‹œìŠ¤í…œìœ¼ë¡œ ì™„ë²½í•œ ë¹„ë””ì˜¤ ì œì‘ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ì„¸ìš”!**
